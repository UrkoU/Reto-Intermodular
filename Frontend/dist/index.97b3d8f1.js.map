{"mappings":"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","sources":["scripts/map.js","L.js"],"sourcesContent":["import L from \"leaflet\";\r\n\r\n// Así se pueden guardar los marcadores para cambiar el color\r\nlet aMarcadores = new L.layerGroup();\r\n\r\nlet mapa;\r\n\r\nconst iconoSeleccionado = L.icon({\r\n  iconUrl: \"../images/marker-selected.png\",\r\n  iconSize: [41, 41],\r\n});\r\n\r\nfunction CargarMapa() {\r\n  // Carga el mapa de leaflet\r\n  if (mapa) mapa.remove();\r\n  mapa = L.map(\"map\").setView([42.983333333333, -2.6166666666667], 8.4);\r\n  L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n  }).addTo(mapa);\r\n  if (aGuardados.length > 0) $(\"#map\").hide();\r\n}\r\n\r\nfunction CargarMarcadores() {\r\n  // Carga los marcadores\r\n  EliminarMarcadores();\r\n  aMarcadores = new L.LayerGroup();\r\n  aMarcadores.clearLayers();\r\n  // Cargar los marcadores de cada baliza\r\n  aBalizas.forEach((oBaliza) => {\r\n    let icono;\r\n    if (bBalizaExiste(oBaliza.codigo)) {\r\n      icono = iconoSeleccionado;\r\n    } else {\r\n      icono = iconoDefecto;\r\n    }\r\n    const marcador = L.marker([oBaliza.latitud, oBaliza.longitud], {\r\n      customId: `marcador${oBaliza.codigoBaliza}`,\r\n      icon: icono,\r\n    });\r\n    marcador.bindPopup(`${oBaliza.nombre}`);\r\n    marcador.on(\"click\", (marc) => {\r\n      AnadirAMapa(marc, oBaliza);\r\n    });\r\n    aMarcadores.addLayer(marcador);\r\n  });\r\n  mapa.addLayer(aMarcadores);\r\n}\r\n\r\nfunction EliminarMarcadores() {\r\n  mapa.removeLayer(aMarcadores);\r\n}\r\n\r\nfunction CambiarIconoMarcador(element, icono) {\r\n  element.target.setIcon(icono);\r\n}\r\n\r\nfunction AnadirAMapa(clickedElement, oBaliza) {\r\n  // Comprueba límite de guardados y que no esté ya seleccionado\r\n\r\n  if (aGuardados.length < iMaxGuardados && !bBalizaExiste(oBaliza.codigo)) {\r\n    CambiarIconoMarcador(clickedElement, iconoSeleccionado);\r\n\r\n    ObtenerTiempo(oBaliza.codigo);\r\n\r\n    aGuardados.push({\r\n      idUsuario: usuario.id,\r\n      codigoBaliza: oBaliza.codigo,\r\n      temperatura: true,\r\n      sensacionTermica: true,\r\n      humedad: true,\r\n      velocidadViento: false,\r\n      direccionViento: false,\r\n      horaAmanecer: false,\r\n      horaAtardecer: false,\r\n      presionAtmosferica: false,\r\n    });\r\n    GuardarMarcadores(aGuardados);\r\n  } else {\r\n    if (bBalizaExiste(oBaliza.codigo)) {\r\n      // Si el código ya está, elimina la baliza y lo guarda en el local storage\r\n      let s = aGuardados.findIndex((e) => e.codigoBaliza == oBaliza.codigo);\r\n      aGuardados.splice(s, 1);\r\n      DeleteOpcionUsuario(usuario.id, oBaliza.codigo);\r\n      // aGuardados.delete(oBaliza.codigo);\r\n      GuardarMarcadores(aGuardados);\r\n      $(`#div${oBaliza.codigo}`).remove();\r\n      CambiarIconoMarcador(clickedElement, iconoDefecto);\r\n    } else {\r\n      MostrarError(limitError);\r\n    }\r\n  }\r\n}\r\n\r\nfunction AnadirCarta(oTiempo) {\r\n  // Añade la carta seleccionada a la lista\r\n  let oOpciones = ObtenerGuardadoPorId(oTiempo.codigo);\r\n  $(\"#divContainer\").append(\r\n    `<div id=\"div${oTiempo.codigo}\" class=\"infoTiempo mw-50 droppableItem\">\r\n      <div class=\"d-flex justify-content-between align-items-center\">\r\n        <span class=\"cardTitle\" id=\"nombre${oTiempo.codigo}\">${oTiempo.nombre}</span>\r\n        <img id=\"img${oTiempo.codigo}\" class=\"cardImg\" alt=\"${\r\n      oTiempo.descripcion\r\n    }\" src=\"images/${oTiempo.descripcion.toLowerCase()}-white.png\" >\r\n      </div>\r\n    </div>`\r\n  );\r\n\r\n  $(`#div${oTiempo.codigo}`).on(\"click\", () => {\r\n    MostrarCartaGrande(oTiempo);\r\n  });\r\n\r\n  $(`#div${oTiempo.codigo}`).hover(function () {\r\n    $(this).css(\"cursor\", \"pointer\");\r\n  });\r\n\r\n  $(`#div${oTiempo.codigo}`).append(`<div id=\"info${oTiempo.codigo}\" ></div>`);\r\n  for (const key in oPropiedadesCortas) {\r\n    if (!key.includes(\"Nombre\"))\r\n      if (key == \"horaAtardecer\" || key == \"horaAmanecer\") {\r\n        let f = new Date(parseInt(oTiempo[key]) * 1000);\r\n\r\n        $(`#info${oTiempo.codigo}`).append(\r\n          `<div id=\"${key}${oTiempo.codigo}\">${oPropiedadesCortas[key + \"Nombre\"]}\r\n          <span id=\"value${key}${oTiempo.codigo}\">${f.customFormat(\"#hhhh#:#mm#\")}</span>\r\n          ${oPropiedadesCortas[key]}</div>`\r\n        );\r\n      } else\r\n        $(`#info${oTiempo.codigo}`).append(\r\n          `<div id=\"${key}${oTiempo.codigo}\">${oPropiedadesCortas[key + \"Nombre\"]}\r\n          <span id=\"value${key}${oTiempo.codigo}\">${oTiempo[key]}</span>\r\n           ${oPropiedadesCortas[key]}</div>`\r\n        );\r\n  }\r\n  for (const key in oOpciones) {\r\n    if (!oOpciones[key]) {\r\n      $(`#${key}${oOpciones.codigoBaliza}`).hide();\r\n    }\r\n  }\r\n\r\n  CrearDroppables();\r\n}\r\n\r\nfunction ActualizarCarta(oTiempo) {\r\n  for (const key in oPropiedadesCortas) {\r\n    if (!oPropiedadesCortas[key].includes(\"Nombre\")) {\r\n      $(`#value${oPropiedadesCortas[key]}${oTiempo.codigo}`).val(oTiempo[key]);\r\n    }\r\n  }\r\n}\r\n\r\nfunction bBalizaExiste(codigoBaliza) {\r\n  return aGuardados.some((e) => e.codigoBaliza === codigoBaliza);\r\n}\r\n\r\nwindow.CargarMapa = CargarMapa;\r\nwindow.CargarMarcadores = CargarMarcadores;\r\nwindow.AnadirCarta = AnadirCarta;\r\nwindow.ActualizarCarta = ActualizarCarta;\r\nwindow.aMarcadores = aMarcadores;\r\n","module.exports=L;"],"names":["$88ec7b2cc8c60a7c$var$mapa","$88ec7b2cc8c60a7c$var$aMarcadores","$parcel$interopDefault","$66ba7a37141049c3$exports","L","layerGroup","$88ec7b2cc8c60a7c$var$iconoSeleccionado","icon","iconUrl","iconSize","$88ec7b2cc8c60a7c$var$CambiarIconoMarcador","element","icono","target","setIcon","remove","map","setView","tileLayer","attribution","addTo","aGuardados","length","$","hide","removeLayer","LayerGroup","clearLayers","aBalizas","forEach","oBaliza","$88ec7b2cc8c60a7c$var$bBalizaExiste","codigo","iconoDefecto","marcador","marker","latitud","longitud","customId","codigoBaliza","bindPopup","nombre","on","marc","clickedElement","iMaxGuardados","ObtenerTiempo","push","idUsuario","usuario","id","temperatura","sensacionTermica","humedad","velocidadViento","direccionViento","horaAmanecer","horaAtardecer","presionAtmosferica","GuardarMarcadores","s","findIndex","e","splice","DeleteOpcionUsuario","MostrarError","limitError","$88ec7b2cc8c60a7c$var$AnadirAMapa","addLayer","oTiempo","oOpciones","ObtenerGuardadoPorId","append","descripcion","toLowerCase","MostrarCartaGrande","hover","css","key","f","Date","parseInt","oPropiedadesCortas","customFormat","key1","CrearDroppables","includes","val"],"version":3,"file":"index.97b3d8f1.js.map"}