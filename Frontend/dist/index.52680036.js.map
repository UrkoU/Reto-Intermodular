{"mappings":"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","sources":["scripts/main.js"],"sourcesContent":["let aBalizas = [];\r\nlet oTiempo = {};\r\n\r\nlet sColorPrincipal = \"\";\r\nlet sColorSecundario = \"\";\r\n\r\nlet bLogueado = false;\r\n\r\nlet tTimeout;\r\n\r\nlet iconoDefecto;\r\n\r\n// Máximo de Marcadores guardados\r\nlet iMaxGuardados = 5;\r\n\r\nfunction PreLogin() {\r\n  CargarLocalStorage();\r\n  CargarColorInicial();\r\n\r\n  CrearSlider();\r\n}\r\n\r\nfunction PostLogin() {\r\n  var promesa2 = GetOpcionesUsuario(usuario.id);\r\n  promesa2.then((res) => {\r\n    aGuardados = JSON.parse(res);\r\n    CargarAjustes();\r\n    OcultarLogin();\r\n    CargarMapa();\r\n    ObtenerBalizas();\r\n    setInterval(ActualizarDatos, 10000);\r\n  });\r\n}\r\n\r\n$(\"document\").ready(function () {\r\n  PreLogin();\r\n  if (bLogueado == true && usuario) {\r\n    console.log(usuario);\r\n    PostLogin();\r\n  } else {\r\n    MostrarLogin();\r\n  }\r\n});\r\n\r\nfunction ObtenerBalizas() {\r\n  var promise = GetBalizas();\r\n  promise.then(function (data) {\r\n    aBalizas = JSON.parse(data);\r\n    CargarMarcadores();\r\n    CargarCartas(aGuardados);\r\n  });\r\n}\r\n\r\nfunction ObtenerTiempo(id) {\r\n  var promise = GetTiempo(id);\r\n  promise.then(function (data) {\r\n    oTiempo = JSON.parse(data);\r\n    AnadirCarta(oTiempo);\r\n  });\r\n}\r\n\r\n$(\"#mapTop\").click(() => {\r\n  $(\"#map\").toggle();\r\n});\r\n\r\nfunction MostrarLogin() {\r\n  $(\"#divBlur\").css(\"display\", \"flex\");\r\n  $(\"#divLoginContainer\").css(\"display\", \"flex\");\r\n  $(\"#divLogin\").css(\"display\", \"flex\");\r\n}\r\n\r\nfunction OcultarLogin() {\r\n  $(\"#divBlur\").css(\"display\", \"none\");\r\n  $(\"#divLoginContainer\").css(\"display\", \"none\");\r\n  $(\"#divLogin\").css(\"display\", \"none\");\r\n}\r\n\r\nfunction MostrarCartaGrande(oTiempo) {\r\n  $(\"#divBlur\").show();\r\n  $(\"#divCartaGrande\").css(\"display\", \"flex\");\r\n  $(\"#grTitulo\").text(oTiempo.nombre);\r\n  $(\"#grTemperatura\").text(oTiempo.temperatura);\r\n  $(\"#grSensacionTermica\").text(oTiempo.sensacionTermica);\r\n  $(\"#grHumedad\").text(oTiempo.humedad);\r\n  $(\"#grPresionAtmosferica\").text(oTiempo.presionAtmosferica);\r\n  $(\"#grVelocidadViento\").text(oTiempo.velocidadViento);\r\n  $(\"#grHoraAmanecer\").text(new Date(parseInt(oTiempo.horaAmanecer) * 1000).customFormat(\"#hhhh#:#mm#\"));\r\n  $(\"#grHoraAtardecer\").text(new Date(parseInt(oTiempo.horaAtardecer) * 1000).customFormat(\"#hhhh#:#mm#\"));\r\n  $(\"#grLatitud\").text(oTiempo.latitud);\r\n  $(\"#grLongitud\").text(oTiempo.longitud);\r\n  $(\"#divBlur\").click(() => {\r\n    OcultarCartaGrande();\r\n  });\r\n  $(`#grImg`).attr(\"src\", `./images/${oTiempo.descripcion.toLowerCase()}-white.png`);\r\n  $(`#grFlecha`).attr(\"src\", `./images/arrow-${sColorPrincipal}.png`);\r\n  $(`#grFlecha`).css({ transform: \"rotate(\" + oTiempo.direccionViento + \"deg)\" });\r\n  console.log(oTiempo);\r\n}\r\n\r\nfunction OcultarCartaGrande(params) {\r\n  $(\"#divBlur\").hide();\r\n  $(\"#divCartaGrande\").css(\"display\", \"none\");\r\n  console.log(\"OCULTAR CARTA GRANDE\");\r\n}\r\n\r\nfunction MostrarError(error = limitError) {\r\n  clearTimeout(tTimeout);\r\n  $(\"#divError\").text(error);\r\n  // Mostrar error, esperar 2 segundos, ocultar\r\n  $(\"#divError\").removeClass(\"hidden\");\r\n  tTimeout = setTimeout(() => {\r\n    $(\"#divError\").addClass(\"hidden\");\r\n  }, 2000);\r\n}\r\n\r\nfunction CargarCartas(balizas) {\r\n  $(`#divContainer`).empty();\r\n  // if (oGuardados[test].length >= 0)\r\n  balizas.forEach((element) => {\r\n    ObtenerTiempo(element.codigoBaliza);\r\n  });\r\n}\r\n\r\nfunction CargarColorInicial() {\r\n  // Carga el color inicial según el local storage\r\n  let sValor, sValorSecundario;\r\n  aColores.forEach((element) => {\r\n    if (element.nombre == sColorPrincipal) {\r\n      sValor = element.valor;\r\n    }\r\n    if (element.nombre == sColorSecundario) sValorSecundario = element.valor;\r\n  });\r\n\r\n  CambiarColorPrimario(sColorPrincipal, sValor, true);\r\n  CambiarColorSecundario(sColorSecundario, sValorSecundario);\r\n}\r\n\r\nfunction CambiarColorPrimario(sColor, sValor, bInicio = false) {\r\n  sColorPrincipal = sColor;\r\n  // Cambia el color predominante de la web, cambiando la variable --main-color del css\r\n  localStorage.setItem(\"sColorPrimario\", sColor);\r\n  document.documentElement.style.setProperty(\"--main-color\", sValor);\r\n  iconoDefecto = L.icon({\r\n    iconUrl: `../images/marker-${sColor}.png`,\r\n    iconSize: [41, 41],\r\n  });\r\n  if (!bInicio) CargarMarcadores();\r\n  // document.getElementsByTagName(\"body\")[0].style.backgroundImage = `url('imagenes/background-${sColor}.png')`;\r\n}\r\n\r\nfunction CambiarColorSecundario(sColor, sValor) {\r\n  sColorSecundario = sColor;\r\n  localStorage.setItem(\"sColorSecundario\", sColor);\r\n  document.documentElement.style.setProperty(\"--secondary-color\", sValor);\r\n}\r\n\r\nfunction CargarAjustes() {\r\n  // Carga los botones de los colores != mainColor\r\n  let divColoresPrincipales = document.getElementById(\"divColoresPrincipales\");\r\n  let divColoresSecundarios = document.getElementById(\"divColoresSecundarios\");\r\n  divColoresPrincipales.innerHTML = \"\";\r\n  divColoresSecundarios.innerHTML = \"\";\r\n  $(`#textUser`).html(usuario.username);\r\n\r\n  sColorPrincipal = localStorage.getItem(\"sColorPrimario\");\r\n  sColorSecundario = localStorage.getItem(\"sColorSecundario\");\r\n  aColores.forEach((oColor) => {\r\n    // Si no es el color principal, añade el botón\r\n    divColoresPrincipales.innerHTML += `<button class=\"color-button color-button-small\" style=\"background-color: ${oColor.valor}\" onclick=\"CambiarColorPrimario('${oColor.nombre}', '${oColor.valor}')\"></button>`;\r\n    divColoresSecundarios.innerHTML += `<button class=\"color-button color-button-small\" style=\"background-color: ${oColor.valor}\" onclick=\"CambiarColorSecundario('${oColor.nombre}', '${oColor.valor}')\"></button>`;\r\n  });\r\n}\r\n\r\n$(`#btnLogout`).on(\"click\", () => {\r\n  Logout();\r\n});\r\n\r\n// Gif de ajustes en hover\r\n$(\".settings\").hover(function () {\r\n  $(this).css(\"background\", \"url(../images/settings.gif)\");\r\n  $(this).css(\"background-repeat\", \"no-repeat\");\r\n  $(this).css(\"background-position\", \"center\");\r\n  $(this).css(\"background-size\", \"3.5em\");\r\n});\r\n\r\n$(\".settings\").mouseleave(function () {\r\n  $(this).css(\"background\", \"url(../images/settings-stopped.gif)\");\r\n  $(this).css(\"background-repeat\", \"no-repeat\");\r\n  $(this).css(\"background-position\", \"center\");\r\n  $(this).css(\"background-size\", \"3.5em\");\r\n});\r\n\r\n// Eventos botón flotante\r\n$(\"#show\").on(\"mouseover\", function () {\r\n  $(\"#colores\").removeClass(\"hidden\");\r\n});\r\n$(\"#show\").on(\"mouseout\", function () {\r\n  $(\"#colores\").addClass(\"hidden\");\r\n});\r\n"],"names":["tTimeout","iconoDefecto","aBalizas","oTiempo1","sColorPrincipal","sColorSecundario","bLogueado","iMaxGuardados","PreLogin","CargarLocalStorage","CargarColorInicial","CrearSlider","PostLogin","GetOpcionesUsuario","usuario","id","then","res","aGuardados","JSON","parse","CargarAjustes","OcultarLogin","CargarMapa","ObtenerBalizas","setInterval","ActualizarDatos","GetBalizas","data","CargarMarcadores","CargarCartas","ObtenerTiempo","GetTiempo","AnadirCarta","MostrarLogin","$","css","MostrarCartaGrande","oTiempo","show","text","nombre","temperatura","sensacionTermica","humedad","presionAtmosferica","velocidadViento","Date","parseInt","horaAmanecer","customFormat","horaAtardecer","latitud","longitud","click","OcultarCartaGrande","attr","descripcion","toLowerCase","transform","direccionViento","console","log","params","hide","MostrarError","error","limitError","clearTimeout","removeClass","setTimeout","addClass","balizas","empty","forEach","element","codigoBaliza","sValor","sValorSecundario","aColores","valor","CambiarColorPrimario","CambiarColorSecundario","sColor","bInicio","localStorage","setItem","document","documentElement","style","setProperty","L","icon","iconUrl","iconSize","divColoresPrincipales","getElementById","divColoresSecundarios","innerHTML","html","username","getItem","oColor","ready","toggle","on","Logout","hover","this","mouseleave"],"version":3,"file":"index.52680036.js.map"}